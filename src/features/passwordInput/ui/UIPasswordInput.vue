<script setup lang="ts">
import UIInput from "@/shared/input/ui/UIInput.vue";
import type { UIPasswordInputProps } from "../lib/types";
import { ref } from "vue";

const value = defineModel("value", { type: String, required: true });
const props = defineProps<UIPasswordInputProps>();

const hidden = ref(true);

function hidePassword() {
  hidden.value = true;
}

function showPassword() {
  hidden.value = false;
}
</script>

<template>
  <UIInput
    v-model:value="value"
    :placeholder="props.placeholder"
    :type="hidden ? 'password' : 'text'"
    :error="props.error"
  >
    <template v-slot:button>
      <button
        v-if="hidden"
        @click="showPassword"
      >
        <svg
          width="16"
          height="11"
          viewBox="0 0 16 11"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M0.0311078 5.32101C1.13972 2.22077 4.29539 0 8 0C11.7046 0 14.8603 2.22077 15.9689 5.32101C16.0104 5.437 16.0104 5.563 15.9689 5.67899C14.8603 8.77923 11.7046 11 8 11C4.29539 11 1.13972 8.77923 0.0311078 5.67899C-0.0103693 5.563 -0.0103693 5.437 0.0311078 5.32101ZM1.17887 5.5C2.18141 8.05388 4.84528 9.9 8 9.9C11.1547 9.9 13.8186 8.05388 14.8211 5.5C13.8186 2.94612 11.1547 1.1 8 1.1C4.84528 1.1 2.18141 2.94612 1.17887 5.5ZM8 3.3C6.73764 3.3 5.71429 4.28497 5.71429 5.5C5.71429 6.71503 6.73764 7.7 8 7.7C9.26237 7.7 10.2857 6.71503 10.2857 5.5C10.2857 4.28497 9.26237 3.3 8 3.3ZM4.57143 5.5C4.57143 3.67746 6.10645 2.2 8 2.2C9.89355 2.2 11.4286 3.67746 11.4286 5.5C11.4286 7.32254 9.89355 8.8 8 8.8C6.10645 8.8 4.57143 7.32254 4.57143 5.5Z"
            fill="currentColor"
          />
        </svg>
      </button>
      <button
        v-else
        @click="hidePassword"
      >
        <svg
          width="16"
          height="16"
          viewBox="0 0 16 16"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M7.99843 3.33333C7.57882 3.33235 7.16051 3.38015 6.75194 3.47579C6.39344 3.5597 6.03479 3.33711 5.95088 2.97861C5.86696 2.62011 6.08956 2.26146 6.44806 2.17755C6.957 2.05841 7.47807 1.99883 8.00077 2L8.00157 2L8 2.66667V2H8.00077C10.6001 2.00029 12.5971 3.48443 13.903 4.87737C14.5621 5.5804 15.0653 6.28088 15.4038 6.80498C15.5734 7.06768 15.7028 7.28776 15.7907 7.44399C15.8347 7.52215 15.8683 7.58447 15.8915 7.62829C15.9031 7.65021 15.9121 7.66752 15.9184 7.67988L15.926 7.69469L15.9283 7.69925L15.9291 7.7008C15.9291 7.7008 15.9296 7.70186 15.3333 8L14.7454 7.68573C14.6892 7.7909 14.6314 7.89518 14.572 7.99851C14.4992 7.87283 14.4029 7.7129 14.2837 7.52835C13.9764 7.05246 13.5212 6.4196 12.9303 5.78929C11.7363 4.51571 10.067 3.33333 8 3.33333L7.99843 3.33333ZM14.572 7.99851C14.2271 8.59878 13.8293 9.16735 13.3832 9.69744C13.1462 9.97916 13.1824 10.3997 13.4641 10.6368C13.7458 10.8738 14.1664 10.8376 14.4034 10.5559C14.986 9.86355 15.4947 9.11227 15.9213 8.31428C16.0232 8.12357 16.0263 7.89527 15.9296 7.70186L15.3333 8C14.737 8.29814 14.7372 8.29849 14.7372 8.29849L14.7368 8.29758L14.7326 8.28952C14.7286 8.2817 14.7221 8.26906 14.713 8.25192C14.6948 8.21762 14.6667 8.16535 14.6286 8.09767C14.6117 8.06757 14.5928 8.03444 14.572 7.99851ZM4.56985 3.6354C4.79331 3.92803 4.73723 4.3464 4.4446 4.56985C3.22126 5.50401 2.19641 6.67091 1.42838 8.00211C1.5011 8.1277 1.59728 8.2874 1.71628 8.47165C2.02362 8.94754 2.47878 9.5804 3.06969 10.2107C4.26263 11.4832 5.93008 12.6646 7.99456 12.6667C9.28309 12.6444 10.5309 12.2111 11.5559 11.4298C11.8487 11.2066 12.267 11.263 12.4902 11.5559C12.7134 11.8487 12.657 12.267 12.3641 12.4902C11.1114 13.4451 9.58591 13.9742 8.0109 13.9999L8 14C5.40033 14 3.40299 12.5157 2.09698 11.1226C1.43789 10.4196 0.93471 9.71913 0.596224 9.19502C0.426567 8.93232 0.297195 8.71224 0.209314 8.55601C0.165349 8.47785 0.131693 8.41553 0.108502 8.37171C0.0969045 8.34979 0.0879168 8.33249 0.0815587 8.32012L0.0739934 8.30531L0.0716927 8.30075L0.0709135 8.2992C0.0709135 8.2992 0.070382 8.29814 0.666667 8L0.0703819 8.29814C-0.0264925 8.10439 -0.023193 7.87566 0.0792296 7.68478C0.953436 6.05562 2.16594 4.63224 3.6354 3.51015C3.92803 3.28669 4.3464 3.34277 4.56985 3.6354ZM7.07441 6.13219C7.32541 6.40156 7.31052 6.8234 7.04115 7.07441C6.91015 7.19647 6.80508 7.34367 6.7322 7.50723C6.65933 7.67078 6.62014 7.84734 6.61699 8.02637C6.61383 8.20539 6.64676 8.38322 6.71382 8.54925C6.78088 8.71527 6.88069 8.86609 7.0073 8.9927C7.13391 9.11931 7.28473 9.21912 7.45075 9.28618C7.61678 9.35324 7.79461 9.38617 7.97363 9.38301C8.15266 9.37986 8.32922 9.34067 8.49277 9.2678C8.65633 9.19492 8.80353 9.08985 8.92559 8.95885C9.1766 8.68948 9.59844 8.67459 9.86782 8.92559C10.1372 9.1766 10.1521 9.59844 9.90107 9.86782C9.65694 10.1298 9.36254 10.34 9.03543 10.4857C8.70832 10.6315 8.35521 10.7098 7.99715 10.7161C7.6391 10.7225 7.28344 10.6566 6.95139 10.5225C6.61935 10.3884 6.31772 10.1887 6.06449 9.93551C5.81127 9.68229 5.61165 9.38065 5.47753 9.04861C5.34341 8.71656 5.27754 8.3609 5.28386 8.00285C5.29018 7.64479 5.36855 7.29168 5.5143 6.96457C5.66005 6.63746 5.87019 6.34306 6.13218 6.09893C6.40156 5.84792 6.8234 5.86281 7.07441 6.13219Z"
            fill="currentColor"
          />
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M0.195262 0.195262C0.455612 -0.0650874 0.877722 -0.0650874 1.13807 0.195262L15.8047 14.8619C16.0651 15.1223 16.0651 15.5444 15.8047 15.8047C15.5444 16.0651 15.1223 16.0651 14.8619 15.8047L0.195262 1.13807C-0.0650873 0.877722 -0.0650873 0.455612 0.195262 0.195262Z"
            fill="currentColor"
          />
        </svg>
      </button>
    </template>
  </UIInput>
</template>

<style scoped lang="scss">
button {
  padding: 0;
  margin: 0;
  background: none;
  color: var(--text-gray);
  border: none;
  cursor: pointer;
  transition: 0.2s all;

  &:hover {
    filter: brightness(0.9);
  }

  &:active {
    filter: brightness(0.6);
  }
}
</style>
